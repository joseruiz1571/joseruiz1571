{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/iso42001-control-schema.json",
  "title": "ISO 42001 Control Data Schema",
  "description": "Schema for storing ISO 42001:2023 AI Management System controls with NIST AI RMF mappings",
  "type": "object",
  "required": ["controlId", "title", "purpose", "implementationGuidance", "aiLifecycleStages", "riskCategories"],
  "properties": {
    "controlId": {
      "type": "string",
      "description": "Unique identifier for the ISO 42001 control (e.g., '5.1', '6.2.1')",
      "pattern": "^[0-9]+(\\.[0-9]+)*$"
    },
    "title": {
      "type": "string",
      "description": "Official title of the control from ISO 42001:2023"
    },
    "section": {
      "type": "string",
      "description": "Section name from ISO 42001 (e.g., 'Leadership', 'Planning', 'Support')"
    },
    "purpose": {
      "type": "string",
      "description": "Purpose and objective of the control"
    },
    "implementationGuidance": {
      "type": "string",
      "description": "Detailed guidance on how to implement the control"
    },
    "aiLifecycleStages": {
      "type": "array",
      "description": "AI lifecycle stages where this control applies",
      "items": {
        "type": "string",
        "enum": [
          "Planning and Design",
          "Data Collection and Processing",
          "Model Development",
          "Verification and Validation",
          "Deployment",
          "Operation and Monitoring",
          "Continuous Improvement",
          "Decommissioning"
        ]
      },
      "minItems": 1
    },
    "riskCategories": {
      "type": "array",
      "description": "Risk categories addressed by this control",
      "items": {
        "type": "string",
        "enum": [
          "Bias and Fairness",
          "Privacy and Data Protection",
          "Security and Robustness",
          "Transparency and Explainability",
          "Accountability and Governance",
          "Safety and Reliability",
          "Legal and Regulatory Compliance",
          "Ethical Considerations",
          "Environmental Impact",
          "Human Oversight and Control"
        ]
      },
      "minItems": 1
    },
    "nistAiRmfMappings": {
      "type": "array",
      "description": "Mappings to NIST AI RMF 1.0 categories and subcategories",
      "items": {
        "type": "object",
        "required": ["function", "category"],
        "properties": {
          "function": {
            "type": "string",
            "description": "NIST AI RMF function",
            "enum": ["GOVERN", "MAP", "MEASURE", "MANAGE"]
          },
          "category": {
            "type": "string",
            "description": "NIST AI RMF category (e.g., 'GV-1.1', 'MS-2.3')"
          },
          "categoryTitle": {
            "type": "string",
            "description": "Title of the NIST AI RMF category"
          },
          "mappingRationale": {
            "type": "string",
            "description": "Explanation of why this ISO 42001 control maps to this NIST category"
          },
          "alignmentStrength": {
            "type": "string",
            "description": "How strongly the control aligns with the NIST category",
            "enum": ["Direct", "Partial", "Supporting"]
          }
        }
      }
    },
    "relatedControls": {
      "type": "array",
      "description": "Related ISO 42001 controls",
      "items": {
        "type": "string"
      }
    },
    "implementationNotes": {
      "type": "array",
      "description": "Additional implementation considerations and best practices",
      "items": {
        "type": "string"
      }
    },
    "evidenceExamples": {
      "type": "array",
      "description": "Examples of evidence that demonstrate control implementation",
      "items": {
        "type": "string"
      }
    }
  }
}
