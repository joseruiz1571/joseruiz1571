/Users/joseruiz-vazquez/grc-tools/ai-governance-scanner/scanner.py:102: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  scan_timestamp=datetime.utcnow().isoformat() + 'Z',
[*] Initializing AI Governance Scanner...
    Region: us-east-1
    Profile: default
    AI Narrator: enabled

[*] Running scan: bedrock-guardrails
    Verifies that AWS Bedrock guardrails are properly configured to prevent:
- Prompt injection attacks (MITRE AML.T0051)
- Model jailbreaking (MITRE AML.T0054)
- PII leakage and privacy violations
- Generation of harmful or inappropriate content

Checks both model attachments AND guardrail configurations.
    Found 4 issue(s)
    Generating executive summaries...
Warning: AI summary generation failed (An error occurred (ResourceNotFoundException) when calling the InvokeModel operation: Model use case details have not been submitted for this account. Fill out the Anthropic use case details form before using the model. If you have already filled out the form, try again in 15 minutes.), using template
Warning: AI summary generation failed (An error occurred (ResourceNotFoundException) when calling the InvokeModel operation: Model use case details have not been submitted for this account. Fill out the Anthropic use case details form before using the model. If you have already filled out the form, try again in 15 minutes.), using template
Warning: AI summary generation failed (An error occurred (ResourceNotFoundException) when calling the InvokeModel operation: Model use case details have not been submitted for this account. Fill out the Anthropic use case details form before using the model. If you have already filled out the form, try again in 15 minutes.), using template

================================================================================
AI GOVERNANCE SCAN REPORT
================================================================================
Scan Time:    2026-01-16T02:36:30.652206Z
AWS Account:  161057983289
AWS Region:   us-east-1

SUMMARY
--------------------------------------------------------------------------------
Total Findings: 4

  High        : 2
  Medium      : 2

FINDINGS DETAIL
--------------------------------------------------------------------------------

[1] AWS-BEDROCK-004 - Medium
    Resource: arn:aws:bedrock:us-east-1:161057983289:guardrail/2gzyj60ily2t
    Issue:    Guardrail 'weak-guardrail-demo' is missing content filters for: MISCONDUCT, SEXUAL, VIOLENCE. Incomplete content filtering allows harmful content in unprotected categories.
    Fix:      Recommended: Add content filters for MISCONDUCT, SEXUAL, VIOLENCE with MEDIUM or HIGH strength to ensure comprehensive content moderation coverage.

    Executive Summary:
    The business impact of this vulnerability is the potential for harmful content to be displayed to users, exposing the organization to legal and reputational risks. Specifically, the lack of content filters enables the "LLM Jailbreaking" and "Societal Harm" attack vectors, as described in the MITRE ATLAS. Addressing this finding would fulfill the "Harmful Output Prevention" and "Content Safety Verification" requirements of the NIST AI Risk Management Framework, as well as the "AI System Safety" and "Risk Treatment" clauses of ISO 42001.

    Compliance Mappings:
      NIST AI RMF: MANAGE 2.2 (Harmful Output Prevention), MEASURE 2.6 (Content Safety Verification)
      ISO 42001:   Annex A.5.4 (AI System Safety), Clause 8.2 (Risk Treatment)
      MITRE ATLAS: AML.T0054 (LLM Jailbreaking), AML.T0048 (Societal Harm)


[2] AWS-BEDROCK-005 - Medium
    Resource: arn:aws:bedrock:us-east-1:161057983289:guardrail/2gzyj60ily2t
    Issue:    Guardrail 'weak-guardrail-demo' has weak filter strengths (LOW or NONE): HATE: input=LOW, output=LOW. LOW strength filters may not catch sophisticated prompt attacks or subtle harmful content.
    Fix:      Recommended: Increase filter strengths to MEDIUM or HIGH. LOW strength should only be used for specific, documented business exceptions.

    Executive Summary:
    Guardrail 'weak-guardrail-demo' has weak filter strengths (LOW or NONE): HATE: input=LOW, output=LOW. LOW strength filters may not catch sophisticated prompt attacks or subtle harmful content. creates regulatory and operational risk exposure. This vulnerability enables AML.T0051 (LLM Prompt Injection) attacks, allowing adversaries to compromise AI system integrity. Remediation addresses MANAGE 1.1 (Safety Controls) and fulfills Clause 8.2 (Risk Treatment), demonstrating due diligence in AI governance.

    Compliance Mappings:
      NIST AI RMF: MANAGE 1.1 (Safety Controls), MEASURE 2.6 (Content Safety Verification)
      ISO 42001:   Clause 8.2 (Risk Treatment), Clause 10.1 (Continual Improvement)
      MITRE ATLAS: AML.T0051 (LLM Prompt Injection), AML.T0054 (LLM Jailbreaking)


[3] AWS-BEDROCK-006 - High
    Resource: arn:aws:bedrock:us-east-1:161057983289:guardrail/2gzyj60ily2t
    Issue:    Guardrail 'weak-guardrail-demo' does not have PII detection enabled. Sensitive personal information (SSN, credit cards, addresses) may be leaked in model outputs.
    Fix:      Recommended: Enable Sensitive Information Policy with PII entity types including NAME, EMAIL, PHONE, SSN, CREDIT_DEBIT_CARD_NUMBER, and ADDRESS. Consider MASK or BLOCK actions.

    Executive Summary:
    Guardrail 'weak-guardrail-demo' does not have PII detection enabled. Sensitive personal information (SSN, credit cards, addresses) may be leaked in model outputs. creates regulatory and operational risk exposure. This vulnerability enables AML.T0024 (Exfiltration via ML Inference API) attacks, allowing adversaries to compromise AI system integrity. Remediation addresses MEASURE 2.4 (Privacy Controls) and fulfills Annex A.8.2 (Data for AI Development), demonstrating due diligence in AI governance.

    Compliance Mappings:
      NIST AI RMF: MEASURE 2.4 (Privacy Controls), GOVERN 4.2 (Privacy Risk Management)
      ISO 42001:   Annex A.8.2 (Data for AI Development), Annex A.8.4 (Data Quality for AI)
      MITRE ATLAS: AML.T0024 (Exfiltration via ML Inference API), AML.T0044 (Full ML Model Access)


[4] AWS-BEDROCK-006 - High
    Resource: arn:aws:bedrock:us-east-1:161057983289:guardrail/pphxwbmu0t2k
    Issue:    Guardrail 'test-content-filter' does not have PII detection enabled. Sensitive personal information (SSN, credit cards, addresses) may be leaked in model outputs.
    Fix:      Recommended: Enable Sensitive Information Policy with PII entity types including NAME, EMAIL, PHONE, SSN, CREDIT_DEBIT_CARD_NUMBER, and ADDRESS. Consider MASK or BLOCK actions.

    Executive Summary:
    Guardrail 'test-content-filter' does not have PII detection enabled. Sensitive personal information (SSN, credit cards, addresses) may be leaked in model outputs. creates regulatory and operational risk exposure. This vulnerability enables AML.T0024 (Exfiltration via ML Inference API) attacks, allowing adversaries to compromise AI system integrity. Remediation addresses MEASURE 2.4 (Privacy Controls) and fulfills Annex A.8.2 (Data for AI Development), demonstrating due diligence in AI governance.

    Compliance Mappings:
      NIST AI RMF: MEASURE 2.4 (Privacy Controls), GOVERN 4.2 (Privacy Risk Management)
      ISO 42001:   Annex A.8.2 (Data for AI Development), Annex A.8.4 (Data Quality for AI)
      MITRE ATLAS: AML.T0024 (Exfiltration via ML Inference API), AML.T0044 (Full ML Model Access)

================================================================================

[!] WARNING: 2 Critical/High severity findings require attention
