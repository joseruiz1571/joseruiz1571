<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cozy Global Kitchen üåçüç≥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #2c3e50;
        }

        #gameContainer {
            background: #f8f5f2;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 1400px;
        }

        #gameCanvas {
            border: 6px solid #8b7355;
            border-radius: 10px;
            display: block;
            background: #c8e6c9;
            box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        #ui {
            margin-top: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .panel {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        h3 {
            color: #e67e22;
            margin-bottom: 12px;
            font-size: 20px;
            border-bottom: 3px solid #f39c12;
            padding-bottom: 8px;
        }

        .dish-name {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .origin {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .ingredient {
            display: inline-block;
            margin: 5px;
            padding: 10px 16px;
            background: #ecf0f1;
            border-radius: 20px;
            font-size: 16px;
            border: 2px solid #bdc3c7;
        }

        .ingredient.collected {
            background: #2ecc71;
            color: white;
            border-color: #27ae60;
        }

        #message {
            grid-column: 1 / -1;
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
        }

        #controls {
            margin-top: 15px;
            text-align: center;
            font-size: 14px;
            color: #7f8c8d;
        }

        .fact {
            background: #fff9e6;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #f39c12;
            margin-top: 10px;
            font-style: italic;
        }

        /* Cooking Animation */
        #cookingOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        #cookingOverlay.active {
            display: flex;
        }

        .cooking-panel {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
        }

        .pan {
            width: 300px;
            height: 200px;
            background: #34495e;
            border-radius: 50% 50% 45% 45%;
            margin: 30px auto;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-30px) rotate(10deg); }
            50% { transform: translateY(-50px) rotate(-10deg); }
            75% { transform: translateY(-30px) rotate(5deg); }
        }

        .ingredient-particle {
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            animation: bounce 1s infinite;
        }

        .btn {
            background: #e67e22;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #d35400;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas" width="1200" height="600"></canvas>
        <div id="ui">
            <div class="panel">
                <h3>üìÖ Day <span id="dayNumber">1</span> Recipe</h3>
                <div class="dish-name" id="dishName">Margherita Pizza</div>
                <div class="origin" id="dishOrigin">üáÆüáπ Italy</div>
                <div id="ingredients"></div>
                <div class="fact" id="fact"></div>
            </div>
            <div class="panel">
                <h3>üéí Your Basket</h3>
                <div id="inventory">Empty</div>
            </div>
            <div id="message">Welcome! Check your recipe and head to the store!</div>
        </div>
        <div id="controls">
            WASD or Arrow Keys to move | SPACE or E to interact
        </div>
    </div>

    <!-- Cooking Animation Overlay -->
    <div id="cookingOverlay">
        <div class="cooking-panel">
            <h2 style="color: #e67e22;">üç≥ Cooking...</h2>
            <div class="pan" id="pan"></div>
            <p id="cookingStatus">Sizzle sizzle...</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Game configuration
        const TILE_SIZE = 60;
        const PLAYER_SIZE = 50;
        const PLAYER_SPEED = 3;

        // Recipe database
        const recipes = [
            {"day": 1, "dish": "Margherita Pizza", "origin": "üáÆüáπ Italy", "ingredients": ["Dough", "Tomato", "Mozzarella", "Basil"], "fact": "The colors represent the Italian flag!"},
            {"day": 2, "dish": "Ramen", "origin": "üáØüáµ Japan", "ingredients": ["Noodles", "Broth", "Egg", "Green Onion"], "fact": "There are over 22 different styles of ramen across Japan."},
            {"day": 3, "dish": "Chilaquiles", "origin": "üá≤üáΩ Mexico", "ingredients": ["Tortillas", "Salsa", "Cheese", "Fried Egg"], "fact": "Traditionally a way to use up leftover tortillas from the day before."},
            {"day": 4, "dish": "Misir Wot", "origin": "üá™üáπ Ethiopia", "ingredients": ["Lentils", "Berbere Spice", "Onion", "Garlic"], "fact": "One of the most popular vegan dishes in Ethiopian cuisine."},
            {"day": 5, "dish": "Pho", "origin": "üáªüá≥ Vietnam", "ingredients": ["Rice Noodles", "Beef", "Star Anise", "Bean Sprouts"], "fact": "A breakfast staple in many parts of Vietnam."},
            {"day": 6, "dish": "Moussaka", "origin": "üá¨üá∑ Greece", "ingredients": ["Eggplant", "Minced Meat", "B√©chamel Sauce", "Potato"], "fact": "The modern version was created by a French-trained Greek chef in the 1920s."},
            {"day": 7, "dish": "Feijoada", "origin": "üáßüá∑ Brazil", "ingredients": ["Black Beans", "Pork", "Beef", "Orange Slice"], "fact": "It is widely considered the national dish of Brazil."}
        ];

        // Game state
        const game = {
            state: 'EXPLORING', // EXPLORING, SHOPPING, COOKING, COMPLETE
            day: parseInt(localStorage.getItem('cozyKitchenDay') || '1'),
            player: {
                x: 150,
                y: 300,
                vx: 0,
                vy: 0
            },
            recipe: null,
            inventory: [],
            keys: {},
            storeItems: [],
            locations: {
                house: { x: 50, y: 200, width: 200, height: 250 },
                stove: { x: 80, y: 280, width: 60, height: 60 },
                store: { x: 950, y: 150, width: 220, height: 350 },
                pond: { x: 400, y: 100, width: 150, height: 100 },
                garden: { x: 300, y: 350, width: 120, height: 120 }
            }
        };

        // Initialize game
        function init() {
            loadDay();
            setupStoreItems();
            updateUI();

            // Keyboard events
            document.addEventListener('keydown', (e) => {
                game.keys[e.key.toLowerCase()] = true;
                if (e.key === ' ' || e.key.toLowerCase() === 'e') {
                    e.preventDefault();
                    handleInteraction();
                }
            });

            document.addEventListener('keyup', (e) => {
                game.keys[e.key.toLowerCase()] = false;
            });

            gameLoop();
        }

        function loadDay() {
            const dayIndex = (game.day - 1) % 7;
            game.recipe = recipes[dayIndex];
            game.inventory = [];
        }

        function setupStoreItems() {
            game.storeItems = game.recipe.ingredients.map((ingredient, i) => ({
                name: ingredient,
                x: 980 + (i % 2) * 90,
                y: 200 + Math.floor(i / 2) * 80,
                width: 70,
                height: 60
            }));
        }

        function setMessage(msg) {
            document.getElementById('message').textContent = msg;
        }

        function updateUI() {
            document.getElementById('dayNumber').textContent = game.day;
            document.getElementById('dishName').textContent = game.recipe.dish;
            document.getElementById('dishOrigin').textContent = game.recipe.origin;
            document.getElementById('fact').textContent = `üí° ${game.recipe.fact}`;

            // Ingredients
            const ingredientsEl = document.getElementById('ingredients');
            ingredientsEl.innerHTML = game.recipe.ingredients.map(item => {
                const collected = game.inventory.includes(item);
                return `<span class="ingredient ${collected ? 'collected' : ''}">${item}</span>`;
            }).join('');

            // Inventory
            const invEl = document.getElementById('inventory');
            if (game.inventory.length === 0) {
                invEl.textContent = 'Empty';
            } else {
                invEl.innerHTML = game.inventory.map(item =>
                    `<span class="ingredient collected">${item}</span>`
                ).join('');
            }
        }

        function handleMovement() {
            // Reset velocity
            game.player.vx = 0;
            game.player.vy = 0;

            // Check keys
            if (game.keys['arrowup'] || game.keys['w']) game.player.vy = -PLAYER_SPEED;
            if (game.keys['arrowdown'] || game.keys['s']) game.player.vy = PLAYER_SPEED;
            if (game.keys['arrowleft'] || game.keys['a']) game.player.vx = -PLAYER_SPEED;
            if (game.keys['arrowright'] || game.keys['d']) game.player.vx = PLAYER_SPEED;

            // Apply movement with collision
            const newX = game.player.x + game.player.vx;
            const newY = game.player.y + game.player.vy;

            if (isValidPosition(newX, newY)) {
                game.player.x = newX;
                game.player.y = newY;
            }
        }

        function isValidPosition(x, y) {
            // Keep in bounds
            if (x < 20 || x > canvas.width - 20 || y < 20 || y > canvas.height - 20) {
                return false;
            }

            // Check house collision (can't walk through walls except door)
            const house = game.locations.house;
            if (x > house.x && x < house.x + house.width &&
                y > house.y && y < house.y + house.height) {
                // Allow if in door area
                if (!(x > house.x + house.width - 40 && y > house.y + house.height / 2 - 30 && y < house.y + house.height / 2 + 30)) {
                    return false;
                }
            }

            return true;
        }

        function handleInteraction() {
            // Check if at store items
            game.storeItems.forEach(item => {
                const dist = Math.hypot(game.player.x - (item.x + item.width/2), game.player.y - (item.y + item.height/2));
                if (dist < 80 && !game.inventory.includes(item.name)) {
                    game.inventory.push(item.name);
                    updateUI();
                    setMessage(`‚úì Picked up ${item.name}! (${game.inventory.length}/${game.recipe.ingredients.length})`);
                }
            });

            // Check if at stove
            const stove = game.locations.stove;
            const distToStove = Math.hypot(game.player.x - (stove.x + stove.width/2), game.player.y - (stove.y + stove.height/2));
            if (distToStove < 80 && game.inventory.length === game.recipe.ingredients.length) {
                startCooking();
            } else if (distToStove < 80) {
                setMessage(`Need all ingredients first! (${game.inventory.length}/${game.recipe.ingredients.length})`);
            }
        }

        function startCooking() {
            const overlay = document.getElementById('cookingOverlay');
            overlay.classList.add('active');

            // Create ingredient particles
            const pan = document.getElementById('pan');
            pan.innerHTML = '';

            const colors = ['#e74c3c', '#f39c12', '#27ae60', '#3498db', '#9b59b6'];
            game.recipe.ingredients.forEach((_, i) => {
                const particle = document.createElement('div');
                particle.className = 'ingredient-particle';
                particle.style.backgroundColor = colors[i % colors.length];
                particle.style.left = `${30 + i * 60}px`;
                particle.style.top = `80px`;
                particle.style.animationDelay = `${i * 0.2}s`;
                pan.appendChild(particle);
            });

            // Play sizzle sound
            playSizzleSound();

            // Show cooking status
            setTimeout(() => {
                document.getElementById('cookingStatus').textContent = '‚ú® Almost ready...';
            }, 2000);

            setTimeout(() => {
                finishCooking();
            }, 4000);
        }

        function finishCooking() {
            const overlay = document.getElementById('cookingOverlay');
            overlay.classList.remove('active');

            setMessage(`üéâ You cooked ${game.recipe.dish}! Delicious! Tomorrow: new recipe!`);

            // Show sleep button
            const messageEl = document.getElementById('message');
            const sleepBtn = document.createElement('button');
            sleepBtn.className = 'btn';
            sleepBtn.textContent = 'üò¥ Sleep until tomorrow';
            sleepBtn.onclick = nextDay;
            messageEl.appendChild(document.createElement('br'));
            messageEl.appendChild(sleepBtn);
        }

        function nextDay() {
            game.day++;
            localStorage.setItem('cozyKitchenDay', game.day);

            // Reset for new day
            loadDay();
            setupStoreItems();
            updateUI();

            // Reset player position
            game.player.x = 150;
            game.player.y = 300;

            setMessage(`üåÖ Day ${game.day}! New recipe: ${game.recipe.dish}`);
        }

        function playSizzleSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const bufferSize = audioContext.sampleRate * 2;
            const noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const output = noiseBuffer.getChannelData(0);

            for (let i = 0; i < bufferSize; i++) {
                output[i] = Math.random() * 2 - 1;
            }

            const whiteNoise = audioContext.createBufferSource();
            whiteNoise.buffer = noiseBuffer;

            const bandpass = audioContext.createBiquadFilter();
            bandpass.type = 'bandpass';
            bandpass.frequency.value = 3000;
            bandpass.Q.value = 1;

            const lowpass = audioContext.createBiquadFilter();
            lowpass.type = 'lowpass';
            lowpass.frequency.value = 5000;

            const gainNode = audioContext.createGain();
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.8);

            whiteNoise.connect(bandpass);
            bandpass.connect(lowpass);
            lowpass.connect(gainNode);
            gainNode.connect(audioContext.destination);

            whiteNoise.start(audioContext.currentTime);
            whiteNoise.stop(audioContext.currentTime + 2);
        }

        // Drawing functions
        function drawRect(x, y, w, h, color, radius = 0) {
            ctx.fillStyle = color;
            if (radius) {
                ctx.beginPath();
                ctx.roundRect(x, y, w, h, radius);
                ctx.fill();
            } else {
                ctx.fillRect(x, y, w, h);
            }
        }

        function drawCircle(x, y, r, color) {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, r, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawText(text, x, y, size = 16, color = '#2c3e50', align = 'center') {
            ctx.fillStyle = color;
            ctx.font = `${size}px 'Segoe UI', sans-serif`;
            ctx.textAlign = align;
            ctx.fillText(text, x, y);
        }

        function draw() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw grass background
            ctx.fillStyle = '#c8e6c9';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw path
            drawRect(0, 250, canvas.width, 150, '#d4c5a9');

            // Path details (stones)
            ctx.fillStyle = '#bca68a';
            for (let i = 0; i < 20; i++) {
                drawCircle(i * 60 + 30, 280 + (i % 3) * 40, 8, '#bca68a');
            }

            // Draw house
            const house = game.locations.house;
            drawRect(house.x, house.y, house.width, house.height, '#f4e4d7', 10);
            drawRect(house.x + 10, house.y + 10, house.width - 20, 60, '#c19a6b'); // Roof

            // Windows
            drawRect(house.x + 30, house.y + 90, 50, 50, '#87ceeb');
            drawRect(house.x + 120, house.y + 90, 50, 50, '#87ceeb');

            // Door
            drawRect(house.x + house.width - 35, house.y + house.height / 2 - 30, 30, 60, '#8b4513', 5);
            drawCircle(house.x + house.width - 15, house.y + house.height / 2, 3, '#f39c12');

            // Stove inside (visible through window)
            const stove = game.locations.stove;
            drawRect(stove.x, stove.y, stove.width, stove.height, '#5a6268', 5);
            drawCircle(stove.x + 15, stove.y + 15, 8, '#2c3e50');
            drawCircle(stove.x + 45, stove.y + 15, 8, '#2c3e50');

            // Draw store
            const store = game.locations.store;
            drawRect(store.x, store.y, store.width, store.height, '#fff8e1', 10);
            drawRect(store.x + 10, store.y + 10, store.width - 20, 40, '#ff6f61'); // Awning
            drawText('üõí STORE', store.x + store.width / 2, store.y + 35, 20, 'white');

            // Store items
            game.storeItems.forEach(item => {
                if (!game.inventory.includes(item.name)) {
                    const isNeeded = game.recipe.ingredients.includes(item.name);
                    drawRect(item.x, item.y, item.width, item.height, isNeeded ? '#81c784' : '#e0e0e0', 8);
                    drawText(item.name, item.x + item.width / 2, item.y + item.height / 2 + 5, 12, '#2c3e50');
                }
            });

            // Draw pond (placeholder)
            const pond = game.locations.pond;
            drawRect(pond.x, pond.y, pond.width, pond.height, '#64b5f6', 50);
            drawText('üé£', pond.x + pond.width / 2, pond.y + pond.height / 2 + 10, 30);

            // Draw garden (placeholder)
            const garden = game.locations.garden;
            drawRect(garden.x, garden.y, garden.width, garden.height, '#8d6e63', 10);
            drawText('üå±', garden.x + garden.width / 2, garden.y + garden.height / 2 + 10, 30);

            // Draw player
            drawCircle(game.player.x, game.player.y, PLAYER_SIZE / 2, '#ffcc80');
            drawCircle(game.player.x - 8, game.player.y - 5, 4, '#3e2723'); // Eye
            drawCircle(game.player.x + 8, game.player.y - 5, 4, '#3e2723'); // Eye
            drawCircle(game.player.x, game.player.y + 5, 8, '#ff7043'); // Smile
        }

        function gameLoop() {
            handleMovement();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Start game
        init();
    </script>
</body>
</html>
